-----------
-- RSYNC --
-----------

<!---
# Plantilla H1
## Plantilla H2
### Plantilla H3
-->
<!--- <img src="https://phoneky.co.uk/thumbs/screensavers/down/original/linux_3rj131p8.gif" />
-->

‚≠êÔ∏è **PLANTILLA** ‚≠êÔ∏è

| üî•PLANTILLA TALBA‚ùóüî• | 
| ------------- |
| *Plantilla* |


--------------------------------------------------------------------------------

‚≠êÔ∏è **RSYNC** ‚≠êÔ∏è

DOCUMENTACI√ìN RSYNC:

https://www.digitalocean.com/community/tutorials/how-to-use-rsync-to-sync-local-and-remote-directories 


Rsync client:

‚óè local-local, local-remot, remot-local. NO remot-remot.

‚óè local-local es transfereix tot.

‚óè remot (:) utilitza ssh. Usa algorisme delta-transfer.

‚óè origen acabat amb la barra (dir/dirnom/) implica el contingut de, acabat sense
(dir/dirnom) implica el directori i el seu contingut.

‚óè Observar el tr√†fic de nom√©s la part diferent modificant el n√∫mero de fitxers.

‚óè Tamb√© exemple modificat un fitxer (.img) de 1G afegint-li ‚Äúhola‚Äù.





Rsync servidor:

‚óè directives de configuraci√≥ globals, recursos oferts.

‚óè rw / ro. restriccions d‚Äôacc√©s per usuaris.

‚óè el fitxer de comptes d‚Äôusuari (/etc/rsyncd.secret) ha de tenir permisos 600 sin√≥
genera error.

‚óè llistar: rsync io3:: , llistar un recurs rsync i03::documentaci√≥, descarregar rsync
i03::documentaci√≥ dades








16.12.21 - Pr√°ctica 17 Rsync - Sincro






1. **INSTALAR EL RSYNC**





Consulta el HowTo-ASIX-rsync




1. Pr√†ctica interactiva amb rsync client.

2. En el servidor instalar los paquetes RSYNC - OPENSSH-CLIENT - OPENSSH-SERVER

3. Probar un ssh [user]@[ip]

4. Hacer las practicas de RSYNC.


‚óè Practica cada un dels m√®todes de sincronitzaci√≥ seg√ºents de rsync:

	‚óã Local-local

Desde i14

rsync -avP dir1/ dir3


PRUEBA DE HOY 16.12.21

--
root¬†ÓÇ∞¬†/¬†ÓÇ±¬†tmp¬†ÓÇ∞¬†rsync -avP dir1/ dir3
sending incremental file list
./
file1.txt
              0 100%    0.00kB/s    0:00:00 (xfr#1, to-chk=99/101)
file10.txt
              0 100%    0.00kB/s    0:00:00 (xfr#2, to-chk=98/101)
file100.txt
              0 100%    0.00kB/s    0:00:00 (xfr#3, to-chk=97/101)
file11.txt

--


	‚óã Local-remot

Mi cliente i11

rsync -avP ./keshi/ guest@i14:/var/tmp/keshi/dir1/dir3/

--
/
file1
              0 100%    0.00kB/s    0:00:00 (xfr#1, to-chk=99/101)
file10
              0 100%    0.00kB/s    0:00:00 (xfr#2, to-chk=98/101)
file100
              0 100%    0.00kB/s    0:00:00 (xfr#3, to-chk=97/101)
file11
              0 100%    0.00kB/s    0:00:00 (xfr#4, to-chk=96/101)
file12
              0 100%    0.00kB/s    0:00:00 (xfr#5, to-chk=95/101)
file13
              0 100%    0.00kB/s    0:00:00 (xfr#6, to-chk=94/101)

--




PRUEBA DE HOY 16.12.21


¬†osboxes¬†ÓÇ∞¬†~¬†ÓÇ∞¬†2¬†ÓÇ∞¬†rsync -avP /tmp/dir1/ osboxes@192.168.0.31:/tmp/dir2
osboxes@192.168.0.31's password: 
sending incremental file list
./
file1.txt
              0 100%    0.00kB/s    0:00:00 (xfr#1, to-chk=99/101)
file10.txt
              0 100%    0.00kB/s    0:00:00 (xfr#2, to-chk=98/101)
file100.txt
              0 100%    0.00kB/s    0:00:00 (xfr#3, to-chk=97/101)
file11.txt
              0 100%    0.00kB/s    0:00:00 (xfr#4, to-chk=96/101)
file12.txt
              0 100%    0.00kB/s    0:00:00 (xfr#5, to-chk=95/101)
file13.txt


--

**antes daba un error como este**

¬†osboxes¬†ÓÇ∞¬†~¬†ÓÇ∞¬†rsync -avP /tmp/dir1/ osboxes@192.168.0.31:/tmp/dir2
osboxes@192.168.0.31's password: 
protocol version mismatch -- is your shell clean?
(see the rsync man page for an explanation)
rsync error: protocol incompatibility (code 2) at compat.c(178) [sender=3.1.3]


Para solucionarlo debemos:

mv ~/.bashrc ~/._bashrc




	‚óã Remot-local


Mi cliente i11

rsync -avP guest@i14:/var/tmp/keshi/dir1 /tmp/.
--
guest@i14's password: 
receiving incremental file list
dir1/
dir1/file1
              0 100%    0.00kB/s    0:00:00 (xfr#1, to-chk=99/101)
dir1/file10
              0 100%    0.00kB/s    0:00:00 (xfr#2, to-chk=98/101)
dir1/file100


PRUEBA DE HOY


rsync -avP osboxes@192.168.0.31:/tmp/dir2 /tmp/dir4/
osboxes@192.168.0.31's password: 
receiving incremental file list
dir2/
dir2/file1.txt
              0 100%    0.00kB/s    0:00:00 (xfr#1, to-chk=99/101)
dir2/file10.txt
              0 100%    0.00kB/s    0:00:00 (xfr#2, to-chk=98/101)
dir2/file100.txt



‚óè Observa que

	‚óã local-local es transfereix tot.
	
Es copia tot
	
	‚óã remot (:) utilitza ssh. Usa l‚Äôalgorisme **delta-transfer**.
	

	
	‚óã origen acabat amb la barra (dir/dirnom/) implica el contingut de, acabat sense (dir dir nom) implica el directori i el seu contingut.

‚óè Crea un exemple per observar el funcionament del delta-transfer, per exemple:

‚óã Observar el tr√†fic de nom√©s la part diferent modificant el n√∫mero de fitxers.

rsync -avP

‚óã Tamb√© exemple modificat un fitxer (.img) de 1G afegint-li ‚Äúhola‚Äù.

touch hola.img 

nano hola.img

HOLA 

rsync -avP ./hola.img guest@i14:/var/tmp/keshi/

cat hola.img

nano hola.img

guest@i14:/var/tmp/keshi$ cat hola.img 
HOLAAAAAAAA

guest@i14:/var/tmp/keshi$ cat ADIOS.img 
hola
guest@i14:/var/tmp/keshi$ cat ADIOS.img 
ADIOS
guest@i14:/var/tmp/keshi$ cat ADIOS.img 
ADIOS
hola
guest@i14:/var/tmp/keshi$ 



**SE SOBRE ESCRIBE**






2. Rsync Servidor

‚óè Genera almenys tres recursos rsync.

‚óè Configura els recursos uns de rw i altre sde ro.

‚óè Configura acc√©s segons usuari.

‚óè Practica l‚Äôacc√©s a recursos de servidor rsync:

	‚óã Llistar tots els recursos disponibles

	‚óã Llistar el contingut d‚Äôun recurs

	‚óã Descarregar contingut d‚Äôun recurs







3.12.21 - PT 17 ACC√âS REMOT: RYSNC SERVIDOR


Rsync Servidor

‚óè Genera almenys tres recursos rsync.

touch file{1..3}

‚óè Configura els recursos uns de rw i altre sde ro.

--

root@i14:/etc# cat rsyncd.conf 

lock file = /var/run/rsync.lock
log file = /etc/rsyncd.log
pid file = /var/run/rsyncd.pid

[kpop]
    path = /tmp/keshi
    comment = Dance
    uid = guest
    gid = guest
    read only = no
    list = yes
    auth users = guest,clientesrsync
    secrets file = /etc/rsyncd.secretos
    hosts allow = 10.200.243.211/255.255.255.0
    chroot = false

--

‚óè Configura acc√©s segons usuari.

[NOMBRE DE ARCHIVO FALTA]
--
guest:guest
clientesrsync:password
--

‚óè Practica l‚Äôacc√©s a recursos de servidor rsync:

	‚óã Llistar tots els recursos disponibles
	
--

root@i11:/tmp/keshi# rsync -avz guest@i14::kpop/
Password: 
receiving incremental file list
drwxr-xr-x          4,096 2021/12/03 10:41:51 .
-rw-r--r--              0 2021/12/03 10:41:46 dragon.txt
-rw-r--r--              0 2021/12/03 10:41:51 keshi.txt
-rw-r--r--              0 2021/12/03 10:30:22 prueba.txt
drwxr-xr-x          4,096 2021/12/03 10:31:27 hola
-rw-r--r--              0 2021/12/03 10:31:27 hola/hola.txt

sent 21 bytes  received 177 bytes  132.00 bytes/sec
total size is 0  speedup is 0.00
root@i11:/tmp/keshi# 
--
	‚óã Llistar el contingut d‚Äôun recurs

	
--
root@i11:/tmp/keshi# rsync -avz guest@i14::kpop/hola
Password: 
receiving incremental file list
drwxr-xr-x          4,096 2021/12/03 10:31:27 hola
-rw-r--r--              0 2021/12/03 10:31:27 hola/hola.txt

sent 25 bytes  received 82 bytes  42.80 bytes/sec
total size is 0  speedup is 0.00
root@i11:/tmp/keshi# 

--

	‚óã Descarregar contingut d‚Äôun recurs
--
root@i11:/tmp/keshi# rsync -rtv guest@i14::kpop/keshi.txt dinos/
Password: 
receiving incremental file list
keshi.txt

sent 43 bytes  received 89 bytes  88.00 bytes/sec
total size is 0  speedup is 0.00
root@i11:/tmp/keshi# 
--





--------------------------------------------------------------------------------

```
https://www.digitalocean.com/community/tutorials/how-to-use-rsync-to-sync-local-and-remote-directories
```

cd ~
mkdir dir1
mkdir dir2
touch dir1/file{1..100}


---

rsync -r dir1/ dir2




















--------------------------------------------------------------------------------




















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 
