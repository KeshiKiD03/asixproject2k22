# __Projecte ASIX 2k22__
## __Escola Del Treball__
### __2HISX 2021-2022__
### __Aaron Andal & Cristian Condolo__


<br>
<br>
<br>
<br>

# __CryptoSEC__: "_Careful where you step in_"


![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/CryptoSECLogo.png?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*



<br>
<br>
<br>




# __Index__

+ **ARP Poisoning**: [--> readME <--](#arp-poisoning)

+ **Tipus d'atacs ARP Spoofing**: [--> readME <--](#tipus-datacs-arp-spoofing)

    + **1. Atacs d'inundació MAC**: [--> readME <--](#1-atacs-dinundació-mac)

    + **2. Enverinament de la cache DNS**: [--> readME <--](#2-enverinament-de-la-caché-dns)

    + **3. IP Spoofing**: [--> readME <--](#3-ip-spoofing)

    + **4. Eavesdropping**: [--> readME <--](#4-eavesdropping)

+ **Com prevenir atacs ARP Spoofing?**: [--> readME <--](#com-prevenir-atacs-arp-spoofing)

+ **ARP Poisoning / Spoofing en acció**: [--> readME <--](#arp-poisoning--spoofing-en-acció)

    + **ARP Poisoning / Spoofing (2 parts) (BETTERCAP)**: [--> readME <--](#arp-poisoning--spoofing-2-parts-bettercap)

    + **MITM - Eavesdropping (Sniffing) (BETTERCAP)**: [--> readME <--](#mitm---eavesdropping-sniffing-bettercap)

    + **DNS Poisoning / Spoofing) (BETTERCAP)**: [--> readME <--](#dns-poisoning--spoofing-bettercap)

    + **Spoofing CryptoSEC.NET with DOS Attack (BETTERCAP) (SlowHTTP)**: [--> readME <--](#spoofing-cryptosecnet-with-dos-attack-bettercap-slowhttp)

+ **Bibliografia**: [--> readME <--](#bibliografia)

<br>
<br>
<br>


# __ARP Poisoning__

__ARP Spoofing__ és l'enverinament de taules ARP. 

És una tècnica que utilitzen els pirates informàtics per aconseguir entrar a una xarxa per robar els paquets de dades que passen per la xarxa local. D'aquesta manera podria controlar el trànsit i també fins i tot aturar-lo.

Els __ciberdelinqüents__ poden enviar missatges falsificats ARP a una LAN. 

Aconsegueix vincular la seva __adreça MAC__ amb __l'adreça IP__ d'un servidor, cosa que, com hem vist anteriorment, és necessària.

A partir d'aquell moment començaria a __rebre qualsevol__ tipus d'__informació__ que __ingressi__ a través d'aquesta adreça IP i poder agafar el control del trànsit del tot.

Per tant, podem dir que una suplantació __d'ARP consisteix__ a enviar __missatges ARP falsos__ a __l'Ethernet__. 

Per simplificar les coses, __l'adreça MAC__ de __l'atacant__ amb __l'adreça IP__ i aconsegueix que la informació arribi a les __víctimes__.

La detecció la fem mitjançant ARP invers (RARP) que és un protocol utilitzat per consultar l'adreça IP associada amb una adreça MAC donada. Si es retorna més d'una adreça IP, el clonatge MAC és present.

![](https://miro.medium.com/max/624/1*9ZWwroW_ZdAzmBprTrCt3A.png)
> __Img Source__: *https://miro.medium.com/max/624/1*9ZWwroW_ZdAzmBprTrCt3A.png*
<br>

![](https://info.varonis.com/hubfs/Imported_Blog_Media/arp-poisoning-vs-arp-spoofing-1-1.png?hsLang=en)
> __Img Source__: *https://info.varonis.com/hubfs/Imported_Blog_Media/arp-poisoning-vs-arp-spoofing-1-1.png?hsLang=en*
<br>

## __Tipus d'atacs ARP Spoofing:__

### __1. Atacs d'inundació MAC:__

En un atac típic d'inundació MAC, un switch s'inunda amb paquets, cadascun amb diferents adreces MAC d'origen. La intenció és consumir la memòria limitada reservada al switch per emmagatzemar la taula de traducció de port a físic de MAC.

El resultat d'aquest atac fa que el switch ingressi a un estat anomenat mode d'obertura fallida, en el qual tots els paquets entrants s'emeten a tots els ports (com amb un concentrador), en lloc de simplement cap avall del port correcte segons la operació normal. 

Un usuari malintencionat podria utilitzar un analitzador de paquets (com Wireshark) executant-se de manera promiscu per capturar dades confidencials d'altres ordinadors (com contrasenyes no encriptades, correu electrònic i converses de missatgeria instantània), que no serien accessibles si l'interruptor funcionés amb normalitat.

![](https://media.geeksforgeeks.org/wp-content/uploads/20210403123448/arpspoof2-660x426.png)
> __Img Source__: *https://media.geeksforgeeks.org/wp-content/uploads/20210403123448/arpspoof2-660x426.png*
<br>

## __2. Enverinament de la caché DNS:__

Aquesta és una situació creada o no creada intencionalment que proporciona dades a un servidor de noms d'emmagatzematge en memòria cau que no es va originar en fonts autoritzades del Sistema de noms de domini (DNS). 

Això pot passar a través del disseny incorrecte del programari, la configuració dolenta dels servidors de noms i els escenaris dissenyats maliciosament que exploten l'arquitectura radicionalment oberta del sistema DNS. 

Quan un servidor DNS ha rebut dades no autèntiques i les emmagatzema en memòria cau per augmentar el rendiment en el futur, es considera enverinat, proporcionant les dades no autèntiques als clients del servidor.

![](https://www.imperva.com/learn/wp-content/uploads/sites/13/2019/01/DNS-spoofing.jpg)
> __Img Source__: *https://www.imperva.com/learn/wp-content/uploads/sites/13/2019/01/DNS-spoofing.jpg*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/PROXY.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

## __3. IP Spoofing:__

La suplantació d'IP fa referència a la creació de paquets de Protocol d'Internet (IP) amb un forjat d'adreça IP d'origen, anomenada suplantació d'identitat, amb el propòsit d'ocultar la identitat del remitent o fer-se passar per un altre sistema informàtic.

## __4. Eavesdropping:__

__Eavesdropping__, és un terme traduït al català que és escoltar d'incògnit. 
És l'acte d'escoltar en secret o sigil·losament converses privades o comunicacions d'altres sense el seu consentiment. 

La pràctica és àmpliament considerada com poc ètica, i en moltes jurisdiccions és il·legal. 

D'altra banda, aquesta pràctica s'ha utilitzat tradicionalment en àmbits relacionats amb la seguretat , com ara escoltar trucades telefòniques.

![](https://blog.malwarebytes.com/wp-content/uploads/2018/07/shutterstock_758712814-900x506.jpg)
> __Img Source__: *https://blog.malwarebytes.com/wp-content/uploads/2018/07/shutterstock_758712814-900x506.jpg*
<br>

# __Com prevenir atacs ARP Spoofing?__

+ Aplicació de filtratge d'encaminador.

+ Bloquejar adreces IP sense utilitzar.

+ Permetre l'accés a la xarxa només al trànsit desitjat.

+ Deshabilitar serveis de xarxa innecessaris.

+ Actualització d'antivirus regularment.

+ Tenir una molt bona política de contrasenyes.

+ Limitar la quantitat d'amplada de banda de la xarxa.

+ Ús de la xarxa de filtratge d'accés.

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/prevent-arp-poisoning-attacks-1-1024x589-1.png?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

+ Utilitzar eines de monitorització com Wireshar.

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/WIRESHARK.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

+ Subdividir la xarxa a diverses parts

També podem __subdividir la xarxa__ a diverses parts. Això evita que, en cas que hi hagi un intent d'atac per part d'una persona aliena, que aquest atac afecti només una part i no tota la xarxa global. Això no obstant, requereix una instal·lació de xarxa més complexa.

<br>
<br>
<br>

# __ARP Poisoning / Spoofing en acció__

## __ARP Poisoning / Spoofing (2 parts) (BETTERCAP)__: 

Envenenament de les taules ARP de les víctimes implicades i reenviament de paquets al hacker. Amb el Wireshark - ARP - Nmap, veurem com fa el duplicat de MAC.

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/ARPSPOOF.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/ARP-SPOOF.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*

<br>
<br>
<br>

### __MITM - Eavesdropping (Sniffing) (BETTERCAP)__ 

Amb l'ARP Poisoning d'abans activarem un _sniffer_ i estarem escoltant la màquina afectada i veient les pàgines on visita. Podem captar credencials de pàgines HTTP.

1. Obrir el Bettercap a Kali Linux.

2. Tenim una interfície senzilleta per començar a fer l'atac Man in the Middle. Si fem ``help` podrem veure tots els mòduls disponibles.

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/HELP-BETTERCAP.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*

<br>
<br>
<br>

2. Amb la comanda següent `net.show` ens mostrarà la IP - MAC - Nom local. Seguidament fem un `net.probe on` per observar de forma interactiva i per fer-ho més bonic, amb un `ticker on`

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/BET0.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/BETTERCAP-arspoofing.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/Bettercaps.png?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/BETTERCAP-TICKER.PNG?raw=true)


<br>
<br>
<br>

3. A partir d'aquest moment, quan ja hem escollit la IP de la víctima. Ja podem començar amb el ARP.SPOOF

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/BET3.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/BET1.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/BET2.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/MAN-IN-THE-MIDDLE-ATTACK.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*


<br>
<br>
<br>
<br>
    
### __DNS Poisoning / Spoofing) (BETTERCAP)__ 

Amb l'ARP Spoof d'abans activarem un _dnsspoof_ i injectarem un registre de DNS fals on ens redirigirà a la nostra màquina on hi tindrem una _fake page: m0odle.escoladeltreball.org_ (__Moodle EDT__) i l'enviarem per correu utilitzant __SET__ dient que "_URGENT! L'Eduard ha posat les notes de M06, entra urgentment i mira la nota que tens!!!_" llavors l'usuari entrarà i no se n'adonarà i li robarem les credencials mostrades al __SET__.

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/arps.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/arps0.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/arps1.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/arps2.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/arps3.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*

<br>
<br>

### A partir d'aquí generem el __mail phishing__ desde un compte de gmail robat a __CryptoSEC__.

1. Seleccionem la opció 5: __Mass Mailer Attack__.

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/PHISHING0.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

2. Seleccionem la opció 5: __Mass Mailer Attack__. Omplim les opcions: `1`, `email destination`, `1`, `our email address`, `our email password`, `priority`, `attach file`, `fake email subject`, `body of messeage with END`

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/phish0.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/phish1.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/phish2.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/phish3.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/PHISHING4.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/PHISHING2.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/PHISHING3.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*

<br>
<br>
<br>
<br>
<br>

## __Spoofing CryptoSEC.NET with DOS Attack (BETTERCAP) (SlowHTTP)__

Ídem que l'anterior però els targets son el __SOA__ i el __Forwarding__, els clients interns de CryptoSEC quan hagin d'anar a la pàgina web __cryptosec.net__, entraràn a __cryptos3c.net__ ja que el hacker ha avisat que hi hà una urgència a la pàgina principal i han d'entrar a la pàgina web dada pel hacker i les seves credencials seràn __robades sense que se'n adoni__!

1. El hacker activar el ARP Spoof amb targets del SOA i el Forwarder.

2. El hacker ha realitzat un DOS per tumbar l'apache2 (SOA): `hping3 --randsource -p80 -S --flood 10.200.243.164`

Ara explicaré què significa cada part de l'ordre:

- __p 80__ és el port que triem atacar

- S activa el flag Syn

– flood indica a hping que enviï els paquets a la màxima velocitat possible

- ip_victima és la __ip__ o __domini__ a atacar

Si volem que la nostra ip no sigui visible podem afegir-li l'opció –ai la ip que falsejarem o bé utilitzar –rand-source amb què es generen adreces d'origen ip a l'atzar:

``hping3 --randsource -p80 -S --flood 10.200.243.164``

o també podem utilitzar: `Slowhttptest`, nosaltres utilitzarem __slowhttptest__.

> _slowhttptest - Denial Of Service attacks simulator_

`slowhttptest -c 40000 -H -i 30 -r 500 -l 600 -u http://cryptosec.net`

``-c`` _number of connections
Specifies the target number of connections to establish during the test._

``-H'`` _Starts slowhttptest in SlowLoris mode, sending unfinished HTTP requests._

``-i`` _seconds
Specifies the interval between follow up data for slowrois and Slow POST tests._

``-r`` _connections per second
Specifies the connection rate._

``-l`` _seconds
Specifies test duration in seconds._

``-u`` _URL
Specifies the URL._

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/DOS-CRYPTOSEC.NET.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/PAGE-DOWN.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

2. El hacker activa la pàgina del __cryptos3c.net__ (fake) amb el SET (__Social Engineering Tool__).

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/BETTERCA-CRYPTOSEC0.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/BETTERCA-CRYPTOSEC1.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/BETTERCA-CRYPTOSEC2.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/BETTERCA-CRYPTOSEC3.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

3. El hacker emet un comunicat general a l'empresa dient que s'ha caigut temporalment la pàgina principal i que han d'entrar per la pàgina següent `cryptos3c.net`


4. Des d'un client de la xarxa interna de CryptoSEC 192.168.3.100 (_Linux Lite Client_) es vol conectar a la pàgina web de cryptosec.net, però han emès un comunicat que els redirecciona a __cryptos3c.net__ ja que la pàgina principal ha sigut hackejada amb DOS (denegació de servei).

![](https://github.com/KeshiKiD03/asixproject2k22/blob/main/Photos/BETTERCA-CRYPTOSEC4.PNG?raw=true)
> __Img Source__: *@Aaron & @Cristian 's GitHub*
<br>

5. Les credencials del client han sigut robades!

<br>
<br>
<br>

## --> [ [Tornar a Ciberseguretat](https://github.com/KeshiKiD03/asixproject2k22/blob/main/README.md) ] <--

# __Bibliografia__

### ARP CACHE POISONING / ARP SPOOF

- https://www.redeszone.net/tutoriales/seguridad/que-es-ataque-arp-poisoning/ - ARP POISONING
- https://es.acervolima.com/ataque-mitm-man-in-the-middle-usando-arp-poisoning/ - ARP POISONING 
- - https://www.redeszone.net/tutoriales/redes-cable/ataques-arp-spoofing-evitar/
- https://ourcodeworld.co/articulos/leer/949/como-realizar-un-ataque-dos-http-lento-con-slowhttptest-prueba-la-proteccion-de-tu-servidor-contra-slowloris-en-kali-linux


### DNS CACHE POISONING / DNS SPOOF

- https://www.varonis.com/blog/dns-cache-poisoning - DNSSPOOF
- https://programmerclick.com/article/2815493326/ - DNSSPOOF
- https://www.boomernix.com/2018/03/realizando-un-dns-spoofing.html - DNSSPOOF
- https://www.keyfactor.com/blog/what-is-dns-poisoning-and-dns-spoofing/ - DNSSPOOFING
- https://www.varonis.com/blog/dns-cache-poisoning - CACHE POISON
- https://www.cloudflare.com/learning/dns/dns-cache-poisoning/ - DNSSPOOF
- https://www.okta.com/identity-101/dns-poisoning/ - DNSCACHE POISON
- https://www.youtube.com/watch?v=uQrmKhW35mQ&t=765s - DNSSPOOFING ETTERCAP BACKBOX
- https://www.varonis.com/blog/dns-cache-poisoning - SPOOF DNS CACHE POISONING
- https://www.keyfactor.com/blog/what-is-dns-poisoning-and-dns-spoofing/#:~:text=DNS%20poisoning%2C%20also%20known%20as,web%20servers%20and%20phishing%20websites.https://www.varonis.com/blog/dns-cache-poisoning - CACHE POISONING
- https://www.imperva.com/learn/application-security/dns-spoofing/ - DNSSPOOFING
- https://www.amirootyet.com/post/how-to-spoof-dns-in-kali-linux/ - DNSSPOOFING
- https://www.keyfactor.com/blog/what-is-dns-poisoning-and-dns-spoofing/#:~:text=DNS%20poisoning%2C%20also%20known%20as,web%20servers%20and%20phishing%20websites. - DNSSPOOFING


### SOCIAL ENGINEERING TOOL

- https://www.youtube.com/watch?v=Jjulz-xHwEo&t=2s - SITE CLONER
- https://www.youtube.com/watch?v=GC4wtfMr3t8 - SITE CLONER
- https://www.youtube.com/watch?v=sP_PDnXTX7A&t=9s - SET TOOLKIT
- https://www.youtube.com/watch?v=1TsCybFNrM0&t=315s - SITE CLONER
- https://www.youtube.com/watch?v=jXy9ewmDVBE - SITE CLONER
- https://www.youtube.com/watch?v=u9dBGWVwMMA - PHISHING ATTACKS SCARY
- https://linux.die.net/man/1/slowhttptest - SLOWHTTP

